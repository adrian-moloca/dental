# ============================================================================
# DentalOS Environment Configuration Template
# ============================================================================
# Copy this file to .env and update values for your environment
# Use scripts/setup-env.sh to auto-generate secrets and setup

# ============================================================================
# GENERAL
# ============================================================================
NODE_ENV=development
LOG_LEVEL=debug
TZ=UTC

# ============================================================================
# POSTGRESQL (Auth Service)
# ============================================================================
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
HOST_POSTGRES_PORT=5433
POSTGRES_USER=dental_user
POSTGRES_PASSWORD=CHANGE_ME_POSTGRES_PASSWORD
POSTGRES_DB=dentalos_auth
POSTGRES_SSL=false
POSTGRES_LOGGING=false
POSTGRES_SYNCHRONIZE=false

# ============================================================================
# POSTGRESQL (Subscription Service - Dedicated Instance)
# ============================================================================
POSTGRES_SUBSCRIPTION_HOST=postgres-subscription
POSTGRES_SUBSCRIPTION_INTERNAL_PORT=5432
HOST_POSTGRES_SUBSCRIPTION_PORT=5434
POSTGRES_SUBSCRIPTION_USER=dental_user
POSTGRES_SUBSCRIPTION_PASSWORD=CHANGE_ME_SUBSCRIPTION_DB_PASSWORD
POSTGRES_SUBSCRIPTION_DB=dentalos_subscription
POSTGRES_SUBSCRIPTION_SSL=false

# ============================================================================
# REDIS (Cache & Sessions)
# ============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
HOST_REDIS_PORT=6381
REDIS_PASSWORD=CHANGE_ME_REDIS_PASSWORD
REDIS_DB=0
REDIS_TLS=false
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=1000

# ============================================================================
# RABBITMQ (Message Queue)
# ============================================================================
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_MGMT_PORT=15672
RABBITMQ_USER=dental_admin
RABBITMQ_PASS=CHANGE_ME_RABBITMQ_PASSWORD
RABBITMQ_VHOST=/
RABBITMQ_EXCHANGE=dentalos.events
RABBITMQ_QUEUE_PREFIX=dental.
RABBITMQ_URI=amqp://dental_admin:CHANGE_ME_RABBITMQ_PASSWORD@rabbitmq:5672/

# ============================================================================
# MONGODB (Microservices Databases)
# ============================================================================
MONGO_HOST=mongo
MONGO_PORT=27017
MONGO_URI_GENERIC=mongodb://mongo:27017/dentalos
MONGO_URI_PATIENT=mongodb://mongo:27017/patient
MONGO_URI_SCHEDULING=mongodb://mongo:27017/dental-scheduling
MONGO_URI_ENTERPRISE=mongodb://mongo:27017/enterprise
MONGO_URI_BILLING=mongodb://mongo:27017/billing
MONGO_URI_INVENTORY=mongodb://mongo:27017/inventory
MONGO_URI_CLINICAL=mongodb://mongo:27017/dentalos_clinical
MONGO_URI_PROVIDER=mongodb://mongo:27017/provider-schedule

# Optional MongoDB Authentication
MONGO_USERNAME=
MONGO_PASSWORD=
MONGO_AUTH_SOURCE=admin

# ============================================================================
# MINIO (Object Storage - S3 Compatible)
# ============================================================================
MINIO_ENDPOINT=http://minio:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=CHANGE_ME_MINIO_SECRET_KEY
MINIO_BUCKET=dentalos-storage
MINIO_REGION=us-east-1
MINIO_USE_SSL=false

# ============================================================================
# JWT & AUTHENTICATION SECRETS
# ============================================================================
# These MUST be strong random strings (minimum 32 characters)
# Run scripts/setup-env.sh to auto-generate secure values
JWT_ACCESS_SECRET=CHANGE_ME_JWT_ACCESS_SECRET_MIN_32_CHARS
JWT_REFRESH_SECRET=CHANGE_ME_JWT_REFRESH_SECRET_MIN_32_CHARS
JWT_ACCESS_EXPIRATION=15m
JWT_REFRESH_EXPIRATION=7d
DEVICE_TOKEN_SECRET=CHANGE_ME_DEVICE_TOKEN_SECRET_MIN_32_CHARS
ENCRYPTION_KEY=CHANGE_ME_ENCRYPTION_KEY_MIN_32_CHARS

# ============================================================================
# CORS & SECURITY
# ============================================================================
CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:55173
CORS_CREDENTIALS=true
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ============================================================================
# SERVICE PORTS (Internal Docker Network)
# ============================================================================
AUTH_PORT=3001
PATIENT_PORT=3004
SCHEDULING_PORT=3002
ENTERPRISE_PORT=3017
BILLING_PORT=3010
INVENTORY_PORT=3008
CLINICAL_PORT=3005
PROVIDER_PORT=3003
SUBSCRIPTION_PORT=3011
WEB_PORT=5173
HEALTH_AGGREGATOR_PORT=3099

# ============================================================================
# SERVICE PORTS (Host Machine - Docker Port Mapping)
# ============================================================================
HOST_AUTH_PORT=3301
HOST_PATIENT_PORT=3304
HOST_SCHEDULING_PORT=3302
HOST_ENTERPRISE_PORT=3317
HOST_BILLING_PORT=3310
HOST_INVENTORY_PORT=3308
HOST_CLINICAL_PORT=3305
HOST_PROVIDER_PORT=3303
HOST_SUBSCRIPTION_PORT=3311
HOST_WEB_PORT=5173
HOST_HEALTH_AGGREGATOR_PORT=3399

# ============================================================================
# SERVICE URLS (Inter-Service Communication)
# ============================================================================
AUTH_SERVICE_URL=http://auth:3001
PATIENT_SERVICE_URL=http://patient:3004
SCHEDULING_SERVICE_URL=http://scheduling:3002
ENTERPRISE_SERVICE_URL=http://enterprise:3017
BILLING_SERVICE_URL=http://billing:3010
INVENTORY_SERVICE_URL=http://inventory:3008
CLINICAL_SERVICE_URL=http://clinical:3005
PROVIDER_SERVICE_URL=http://provider-schedule:3003
SUBSCRIPTION_SERVICE_URL=http://subscription:3011
HEALTH_AGGREGATOR_URL=http://health-aggregator:3099

# Service Timeouts (milliseconds)
SUBSCRIPTION_SERVICE_TIMEOUT=5000
DEFAULT_SERVICE_TIMEOUT=10000

# ============================================================================
# STRIPE PAYMENT INTEGRATION
# ============================================================================
STRIPE_API_KEY=sk_test_CHANGE_ME_STRIPE_API_KEY
STRIPE_WEBHOOK_SECRET=whsec_CHANGE_ME_STRIPE_WEBHOOK_SECRET
STRIPE_PUBLISHABLE_KEY=pk_test_CHANGE_ME_STRIPE_PUBLISHABLE_KEY

# ============================================================================
# EMAIL SERVICE (SMTP)
# ============================================================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=CHANGE_ME_SMTP_USER
SMTP_PASSWORD=CHANGE_ME_SMTP_PASSWORD
SMTP_FROM_EMAIL=noreply@dentalos.com
SMTP_FROM_NAME=DentalOS

# ============================================================================
# TWILIO (SMS/Phone Verification)
# ============================================================================
TWILIO_ACCOUNT_SID=CHANGE_ME_TWILIO_ACCOUNT_SID
TWILIO_AUTH_TOKEN=CHANGE_ME_TWILIO_AUTH_TOKEN
TWILIO_PHONE_NUMBER=CHANGE_ME_TWILIO_PHONE_NUMBER

# ============================================================================
# AWS SERVICES (Optional - for production)
# ============================================================================
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_S3_BUCKET=
AWS_SES_FROM_EMAIL=

# ============================================================================
# SENTRY ERROR TRACKING
# ============================================================================
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================================================
# FEATURE FLAGS
# ============================================================================
FEATURE_OFFLINE_MODE=true
FEATURE_REALTIME_SYNC=true
FEATURE_PATIENT_PORTAL=true
FEATURE_TELEMEDICINE=false
FEATURE_ANALYTICS=true
FEATURE_BILLING_INTEGRATION=true
FEATURE_INVENTORY_MANAGEMENT=true
FEATURE_CLINICAL_NOTES=true
FEATURE_APPOINTMENT_REMINDERS=true
FEATURE_MULTI_CLINIC=true
FEATURE_RBAC=true

# ============================================================================
# SWAGGER/API DOCUMENTATION
# ============================================================================
SWAGGER_ENABLED=true
SWAGGER_TITLE=DentalOS API
SWAGGER_DESCRIPTION=Comprehensive Dental Practice Management System
SWAGGER_VERSION=1.0.0

# ============================================================================
# MONITORING & OBSERVABILITY
# ============================================================================
JAEGER_ENABLED=false
JAEGER_AGENT_HOST=jaeger
JAEGER_AGENT_PORT=6831
PROMETHEUS_ENABLED=false
HEALTH_CHECK_INTERVAL=30000
HEALTH_ALERT_WEBHOOK_URL=

# ============================================================================
# FRONTEND ENVIRONMENT VARIABLES (Vite)
# ============================================================================
VITE_API_BASE_URL=http://localhost:3301
VITE_AUTH_API_URL=http://localhost:3301
VITE_PATIENT_API_URL=http://localhost:3304
VITE_SCHEDULING_API_URL=http://localhost:3302
VITE_PROVIDER_API_URL=http://localhost:3303
VITE_BILLING_API_URL=http://localhost:3310
VITE_INVENTORY_API_URL=http://localhost:3308
VITE_CLINICAL_API_URL=http://localhost:3305
VITE_ENTERPRISE_API_URL=http://localhost:3317
VITE_SUBSCRIPTION_API_URL=http://localhost:3311
VITE_WS_URL=ws://localhost:3301
VITE_STRIPE_PUBLISHABLE_KEY=pk_test_CHANGE_ME

# ============================================================================
# DATABASE MIGRATION & SEEDING
# ============================================================================
RUN_MIGRATIONS=true
RUN_SEEDS=false
SEED_DEMO_DATA=false

# ============================================================================
# DEVELOPMENT & DEBUGGING
# ============================================================================
DEBUG_MODE=start:watch
ENABLE_REQUEST_LOGGING=true
ENABLE_SQL_LOGGING=false
ENABLE_MONGO_DEBUG=false
PRETTY_PRINT_LOGS=true

# ============================================================================
# BACKUP & DISASTER RECOVERY
# ============================================================================
BACKUP_ENABLED=false
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=7
BACKUP_S3_BUCKET=

# ============================================================================
# RATE LIMITING & THROTTLING
# ============================================================================
THROTTLE_TTL=60
THROTTLE_LIMIT=100

# ============================================================================
# FILE UPLOAD LIMITS
# ============================================================================
MAX_FILE_SIZE=10485760
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf

# ============================================================================
# SESSION MANAGEMENT
# ============================================================================
SESSION_SECRET=CHANGE_ME_SESSION_SECRET_MIN_32_CHARS
SESSION_MAX_AGE=86400000
MAX_SESSIONS_PER_USER=5

# ============================================================================
# AUDIT LOGGING
# ============================================================================
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=90

# ============================================================================
# GDPR & COMPLIANCE
# ============================================================================
DATA_RETENTION_DAYS=2555
ANONYMIZE_AFTER_DAYS=2920
ENABLE_DATA_EXPORT=true

# ============================================================================
# NOTIFICATIONS
# ============================================================================
ENABLE_EMAIL_NOTIFICATIONS=true
ENABLE_SMS_NOTIFICATIONS=true
ENABLE_PUSH_NOTIFICATIONS=false

# ============================================================================
# SCHEDULER CONFIGURATION
# ============================================================================
SCHEDULER_ENABLED=true
APPOINTMENT_REMINDER_CRON=0 9 * * *
BACKUP_CRON=0 2 * * *

# ============================================================================
# CACHE CONFIGURATION
# ============================================================================
CACHE_TTL=3600
CACHE_MAX_ITEMS=1000
ENABLE_CACHE=true

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================
MAX_POOL_SIZE=20
MIN_POOL_SIZE=5
QUERY_TIMEOUT=30000
CONNECTION_TIMEOUT=10000

# ============================================================================
# DOCKER COMPOSE CONFIGURATION
# ============================================================================
COMPOSE_PROJECT_NAME=dentalos
COMPOSE_PATH_SEPARATOR=:
COMPOSE_FILE=docker-compose.dev.yml
